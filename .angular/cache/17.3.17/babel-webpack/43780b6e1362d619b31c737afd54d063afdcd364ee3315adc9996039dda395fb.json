{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CartService {\n  get isCartOpen() {\n    return this.isCartOpenSubject.value;\n  }\n  set isCartOpen(value) {\n    this.isCartOpenSubject.next(value);\n  }\n  constructor() {\n    this.cartItems = [];\n    this.cartItemsSubject = new BehaviorSubject([]);\n    this.cartItems$ = this.cartItemsSubject.asObservable();\n    this.isCartOpenSubject = new BehaviorSubject(false);\n    this.isCartOpen$ = this.isCartOpenSubject.asObservable();\n    // Load from localStorage if available\n    const savedCart = localStorage.getItem('cart');\n    if (savedCart) {\n      this.cartItems = JSON.parse(savedCart);\n      this.cartItemsSubject.next(this.cartItems);\n    }\n  }\n  addToCart(product) {\n    const existingItem = this.cartItems.find(item => item.id === product.id);\n    if (existingItem) {\n      existingItem.quantity += 1;\n    } else {\n      this.cartItems.push({\n        ...product,\n        quantity: 1\n      });\n    }\n    this.updateCart();\n  }\n  removeFromCart(id) {\n    this.cartItems = this.cartItems.filter(item => item.id !== id);\n    this.updateCart();\n  }\n  updateQuantity(id, quantity) {\n    const item = this.cartItems.find(item => item.id === id);\n    if (item) {\n      item.quantity = quantity;\n      if (item.quantity <= 0) {\n        this.removeFromCart(id);\n      } else {\n        this.updateCart();\n      }\n    }\n  }\n  getTotal() {\n    return this.cartItems.reduce((total, item) => total + item.price * item.quantity, 0);\n  }\n  getCartCount() {\n    return this.cartItems.reduce((count, item) => count + item.quantity, 0);\n  }\n  clearCart() {\n    this.cartItems = [];\n    this.updateCart();\n  }\n  updateCart() {\n    localStorage.setItem('cart', JSON.stringify(this.cartItems));\n    this.cartItemsSubject.next([...this.cartItems]);\n  }\n  static {\n    this.ɵfac = function CartService_Factory(t) {\n      return new (t || CartService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CartService,\n      factory: CartService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","CartService","isCartOpen","isCartOpenSubject","value","next","constructor","cartItems","cartItemsSubject","cartItems$","asObservable","isCartOpen$","savedCart","localStorage","getItem","JSON","parse","addToCart","product","existingItem","find","item","id","quantity","push","updateCart","removeFromCart","filter","updateQuantity","getTotal","reduce","total","price","getCartCount","count","clearCart","setItem","stringify","factory","ɵfac","providedIn"],"sources":["D:\\FILE CUA TRUONG\\Tự Học Đi concho\\Ecomerc web with Payments\\src\\app\\services\\cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\n\r\nexport interface CartItem {\r\n  id: number;\r\n  name: string;\r\n  price: number;\r\n  image: string;\r\n  quantity: number;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CartService {\r\n  private cartItems: CartItem[] = [];\r\n  private cartItemsSubject = new BehaviorSubject<CartItem[]>([]);\r\n  public cartItems$ = this.cartItemsSubject.asObservable();\r\n  \r\n  private isCartOpenSubject = new BehaviorSubject<boolean>(false);\r\n  public isCartOpen$ = this.isCartOpenSubject.asObservable();\r\n  \r\n  get isCartOpen(): boolean {\r\n    return this.isCartOpenSubject.value;\r\n  }\r\n  \r\n  set isCartOpen(value: boolean) {\r\n    this.isCartOpenSubject.next(value);\r\n  }\r\n\r\n  constructor() {\r\n    // Load from localStorage if available\r\n    const savedCart = localStorage.getItem('cart');\r\n    if (savedCart) {\r\n      this.cartItems = JSON.parse(savedCart);\r\n      this.cartItemsSubject.next(this.cartItems);\r\n    }\r\n  }\r\n\r\n  addToCart(product: { id: number; name: string; price: number; image: string }) {\r\n    const existingItem = this.cartItems.find(item => item.id === product.id);\r\n    \r\n    if (existingItem) {\r\n      existingItem.quantity += 1;\r\n    } else {\r\n      this.cartItems.push({\r\n        ...product,\r\n        quantity: 1\r\n      });\r\n    }\r\n    \r\n    this.updateCart();\r\n  }\r\n\r\n  removeFromCart(id: number) {\r\n    this.cartItems = this.cartItems.filter(item => item.id !== id);\r\n    this.updateCart();\r\n  }\r\n\r\n  updateQuantity(id: number, quantity: number) {\r\n    const item = this.cartItems.find(item => item.id === id);\r\n    if (item) {\r\n      item.quantity = quantity;\r\n      if (item.quantity <= 0) {\r\n        this.removeFromCart(id);\r\n      } else {\r\n        this.updateCart();\r\n      }\r\n    }\r\n  }\r\n\r\n  getTotal(): number {\r\n    return this.cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n  }\r\n\r\n  getCartCount(): number {\r\n    return this.cartItems.reduce((count, item) => count + item.quantity, 0);\r\n  }\r\n\r\n  clearCart() {\r\n    this.cartItems = [];\r\n    this.updateCart();\r\n  }\r\n\r\n  private updateCart() {\r\n    localStorage.setItem('cart', JSON.stringify(this.cartItems));\r\n    this.cartItemsSubject.next([...this.cartItems]);\r\n  }\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}